# QuotaWatch — Claude Code用 設計書 + 作業指示書

> **注意: このディレクトリは設計書のアーカイブです。MVPは2026-01-19に完了済みです。**

このZIPは、SwiftBarプラグイン（`zai_quota_backoff.1m.sh`）で実現している **クォータ監視** を、macOSネイティブの **メニューバー常駐アプリ**（SwiftUI / MenuBarExtra）として置き換えるための設計書と作業指示書です。

MVPは **Z.ai（GLM）** のクォータ取得に対応しますが、将来的に他プロバイダ（OpenAI / Anthropic / etc.）へ拡張できるよう、最小限の抽象（Providerプロトコル）を設計に含めます（MVPではUIにプロバイダ選択は出しません）。

## 前提
- 対象OS: **macOS 26.2 (Tahoe, 25C56) 以降**
- 配布（署名・公証・自動更新）は **当面考えない**
- 常駐（ログイン時起動）必須
- 更新間隔はユーザー設定可（最短 **1分**）
- 通知テストボタン必須
- APIキーは一般的・セキュアな方法（Keychain）

## ドキュメント構成
- `docs/` … 詳細設計
- `claude_code/` … Claude Codeでの実装手順・タスク分割・プロンプト
- `spec/` … APIサンプル・状態スキーマ

## ゴール（MVP）
- メニューバーにクォータ使用率と次回リセットまでの残り時間を表示（例: `GLM 5h 42% • 2h36m`）
- API取得（デフォルト: Z.ai `/api/monitor/usage/quota/limit`）
- 429 / 1302 / 1303 / 1305 を **指数バックオフ**（最大15分＋ジッター）
- 失敗時も **キャッシュ値で安定表示**
- リセット跨ぎを **低遅延で通知**（重複防止）
- **通知テスト**ボタン
- 更新間隔はユーザー設定（最短1分）
- KeychainでAPIキー管理
- ログイン時起動（Login Item）

